# 개발 의도 & 설계 문서

## 1. 주요 타겟 사용자 설정의 배경

### 1.1 왜 "(다국적) 대기업 경영팀"인가?

다음과 같은 근본적인 차이점 때문에 소규모 기업은 해당 서비스의 주 사용층이 아니라고 판단했습니다.

1. 데이터 복잡도 : 소규모 기업들은 관리할 데이터의 양이 적거나 배출량 자체가 많지 않습니다.
2. 관리 주체 : 대기업에서는 여러 부서의 다수 인원이 이 서비스를 구매해서 사용하지만, 소규모 기업에서는 1-2명의 담당자만 사용하게 됩니다. 따라서 대기업에서 더 많은 사용자 기반과 수익성을 확보할 수 있습니다.
3. 규제의 정도 : 다국적 대기업은 여러 국가의 서로 다른 탄소 관련 규제를 동시에 준수해야 합니다. 통합된 대시보드를 통해 각국 규제 요구사항에 신속하게 대응할 수 있어 외부 서비스의 필요성이 높습니다.

### 1.2 "데스크탑 환경"에 최적화한 이유

위에서 설명했듯 해당 서비스는 주로 여러명이 함께 데이터를 보며 회의에 참고하거나, 시각화된 데이터를 통해 인사이트를 얻기 위해 사용합니다.

모바일환경에서는 위의 활동을 하지 않습니다. 모바일뷰가 적절한 때는 서비스가 제공하는 데이터가 간단한 형식이며 실시간으로 변화할 떄 입니다. 그래야 사용자가 언제 어디서든지 모바일뷰를 통해 서비스를 이용하는것에 장점이 있는것입니다. 그러나 탄소 배출량은 실시간으로 집계되는 유형의 데이터가 아니며, 사용자가 업무시간과 업무장소 외에 필요한 데이터도 아닙니다.

## 2. 기술 스택 선택과 근거

### 2.1 React Query

리액트 쿼리는 다음과 같은 장점이 있어서 서버상태 관리에 많이 사용되는 라이브러리입니다.

1. 로딩/에러 상태 관리
2. 백그라운드 업데이트

#### React Query vs 간단한 전역 상태

하지만 한정된 시간 안에 UX를 구현해내는것이 목표인 과제에서 굳이 복잡할 수 있는 리액트 쿼리를 사용할 필요가 있을까?

실제로 초기에 시간 관계상 간단히 Zustand 전역 상태(혹은 자체 Context API)에 서버 데이터를 저장하여 사용하는 방식으로 구상했습니다.

하지만 정석적으로 사용되는 스택을 사용해 실제로 운용중일때와 가장 유사한 조건에서 이 웹앱의 성능을 알 수 있을것 같아 리액트 쿼리를 사용하였습니다.

#### 세션 스토리지 도입 가능성

리포트를 제외한 배출량과 관련된 자료들은 실시간성이 매우 낮음을 고려하면 다음과 같은 장점을 생각해 추후에 세션스토리지를 사용하는 옵션도 고려할만 하다고 생각합니다.

- 네트워크 요청 불필요 : 네트워크 연결 상태에 따라 발생할 수 있는 지연을 사전에 방지할 수 있습니다.
- 탭 유지 시 완전한 오프라인 동작 가능 : 필요하다면 이동중에도 대시보드를 이용할 수 있습니다.

### 2.2 Recharts

chart.js와 같은 여러 데이터 시각화 라이브러리들 중 Recharts를 선택한 이유는 React 환경에서의 개발 편의성과 간단한 설정으로 빠른 구현이 가능하기 때문입니다.

**Recharts의 주요 장점**:

- JSX 문법으로 React 개발자에게 친숙한 API
- React 상태와 자연스러운 연동 (props 변경 시 자동 리렌더링)

#### 현재 구현의 아쉬운 점

또 다른 장점으로는 리액트의 문법과 유사해 컴포넌트의 재사용성이 높다는 점이 있습니다만, 아쉽게도 여기서는
이 장점을 100% 활용하지 못했습니다.

Mock-up 개발에서는 재사용 가능한 차트 컴포넌트를 설계하는데 소요되는 시간이 단순 구현에서보다 많기 때문입니다.

실제 프로덕션 상황에서는 바 차트, 라인 차트 등 차트 유형별로 재사용 가능하게 설계하여 코드량을 줄이도록 할 수 있습니다.

## 3. 페이지별 상세 설명 및 UI 설계 의도

### 3.1 Overview 페이지

![](/pic/overview.png)

#### "최근 12개월" 배출량

오버뷰 페이지에는 총 13개의 차트 혹은 정보를 담은 카드가 있는데, 주목할 만 한 것을 뽑자면 최근 12개월의 총 배출량과 최근 12개월의 월간 배출량 라인 차트입니다.

- **연중 일관성**: 언제 접속해도 항상 12개월치 데이터로 일관된 분석 가능
- **UI 내 데이터 일관성**: 바로 옆에 위치한 "연도별 총 배출량" 카드도 12개월치 데이터이므로, 동일한 기간 범위로 직관적인 비교 분석 가능

### 3.2 Analytics 페이지

#### 3.2.1 연도별 분석

![](/pic/anal-year.png)

##### 3.2.1.1 전체 기간 월간 배출량 바 차트

화면 상단의 바 차트는 정보 표시와 인터렉션 기능을 가지고 있는 컴포넌트로 전체 기간의 월별 배출량을 시각화 하면서도, 특정 연도 바를 클릭하면 해당 연도가 선택되어 하단의 상세 차트가 업데이트됩니다.

**설계 의도**:
**사용자의 자연스러운 탐색 패턴**을 고려했습니다.

대부분의 경우 사용자가 특정 연도를 미리 정해놓고 "2022년 데이터를 보자"라고 접근하지 않습니다. 오히려 전체 데이터를 먼저 보면서 "어? 이 해는 왜 배출량이 유독 높지?", "이 해에는 월간 편차가 왜 이렇게 클까?" 같은 **이상 징후나 패턴을 발견**한 후에 해당 연도를 자세히 살펴보고 싶어합니다.

따라서 별도의 연도 선택 드롭다운을 제공하는 대신, **데이터 자체가 선택 인터페이스가 되도록** 설계했습니다. 이를 통해 "발견 → 탐색"의 자연스러운 사용 패턴을 지원합니다.

###### 구현하지 못한 부분: 맥락 정보 타임라인

시간 관계상 구현하지 못했지만, 사용자가 특정 연도를 선택했을 때 **배출량 변화의 맥락을 제공하는 타임라인**을 추가할 수 있습니다.

**타임라인에 포함될 정보들**:

- **사업 변화**: "2022년 1월 - A사 공장 신설"
- **환경 요인**: "2022년 2월 - 기록적 한파로 난방 연료 사용량 급증"
- **규제 변화**: "2022년 6월 - EU 탄소국경조정제도 시행으로 배출량 감소"
- **기술 도입**: "2022년 9월 - B사 재생에너지 전환 완료"

**설계 의도**:
단순히 "배출량이 높다/낮다"를 보여주는 것을 넘어서, **"왜 그랬는지"에 대한 맥락**을 제공하여 데이터 기반 의사결정을 지원합니다. 이를 통해 경영진이 배출량 변화의 원인을 즉시 파악하고, 향후 전략 수립에 활용할 수 있습니다.

##### 3.2.1.2 월간 배출량 비교 차트

화면 우측 중간의 라인 차트는 **선택된 연도와 전년도의 월별 배출량을 동시에 표시**하여 변화 추세를 직관적으로 파악할 수 있게 합니다.

**설계 의도**:
단일 연도 데이터만으로는 해당 수치가 높은지 낮은지 판단하기 어렵습니다. 전년도와의 비교를 통해 경영진이 **개선/악화 여부를 즉시 확인**하고, 일반적인 패턴(가령 겨울에는 배출량이 높을 수 있는 패턴)과 실제 변화를 구분할 수 있도록 설계했습니다.

##### 3.2.1.3 종합 평점

선택된 연도의 **탄소 배출 관리 성과를 종합적으로 평가**하는 점수를 표시합니다.

**평점 산출 요소들**:

- **목표 달성률**: 해당 연도 배출량 목표 대비 실적
- **전년 대비 개선도**: 동기간 배출량 변화율
- **매출 효율성**: 매출 규모 대비 배출량 비율
- **외부 요인 보정**: 기온, 규제 변화 등 통제 불가능한 요인 감안

등이 있을 수 있습니다.

**설계 의도**:
복잡한 데이터를 **단일 지표로 요약**하여 경영진이 해당 연도의 탄소 관리 성과를 직관적으로 평가할 수 있게 합니다.

#### 3.2.2 회사별 분석

![](/pic/anal-company.png)

##### 3.2.2.1 회사 선택과 비교

상단의 회사 목록에서 회사를 선택하면 그리드 레이아웃으로 회사들의 정보를 나열하고 있습니다.

**설계 의도**:

- 회사 선택 : 특정 관심사를 기준으로 회사들을 분류해 서로 비교할 수 있습니다. 가령 같은 지역 혹은 같은 업종에 있는 회사들끼리 비교하거나 혹은 비슷한 매출 규모의 회사들끼리 비교할 수도 있습니다.
- 비교 내용 : 이 페이지에서는 회사들끼리의 비교와 간략한 요약정보 제공이 주요한 기능입니다. 그래서 간략한 정보들 위주로 추렸으며 시간 관계상 구현하지 못한 회사별 자세한 정보는 따로 Companies 페이지에서 구현할수 있습니다.
- 종합 평점 : 여기서도 연도별 카테고리에서처럼 각 회사마다 평점을 가지고 있습니다. 여기에도 다양한 요인들이 설계에 따라 다양하게 작용할 수 있습니다.
  - 회사의 매출 규모 대비 배출량 & 추이
  - 위치한 국가의 규제 상황
  - 주로 사용하는 연료 & 추이

#### 3.2.3 소스별 분석 (미구현)

소스별 분석이 가지는 특징이 있습니다.

소스, 즉 기업에서 탄소배출을 관리하면서 연료를 분석한다는 것의 의미는 결국 연료를 점차 효율적인 연료로 교체하거나 설비 개선과 신기술 도입을 통해 기존 연료로도 더 적게 배출하겠다는 의미입니다.

그래서 더 다양한 데이터를 수집하고 복잡한 계산을 필요로 할 수 있습니다.

- 리스크 분산 관점 차트 : 특정 연료에 지나치게 의존하는 것은 위험하니 다양성을 관리하는데 도움을 주는 차트.
- 비용 효율성 관점 차트 : 해당 소스의 구매비용과 배출량을 해당 소스가 생산하는 에너지량과 비교합니다.

등의 더 정밀한 설계가 필요한 차트들이 주를 이루고 있습니다.

##### 보안 고려

소스별 분석에서는 따라서 단순 대시보드 기능을 넘어 서비스 제공업체에서 제공하는 솔루션에 가깝다고 볼 수 있습니다. 그리고 포함하고 있는 데이터가 연료 구매 단가(당사의 계약 조건), 사용하는 기술과 설비에 대한 정보 등 **민감한 산업 정보**가 있을 수 있기 때문에 더 까다로운 보안 대책이 필요합니다.

##### 페이지 분리 고려

마찬가지로, 단순 대시보드와 성격이 다르기 때문에 insights 라는 페이지에 따로 분리해 더 전문적인 조언을 제공하는 서비스를 따로 구축할 수 있습니다. 제공하는 조언의 퀄리티나 영역에 따라 요금을 다르게 책정해 수익성을 높이는 방법으로 사업의 방향을 잡을 수도 있습니다.

## 4. 아키텍처 개요

### 4.1 상태 관리 구조 (State Boundaries)

#### 4.1.1 서버 상태 (React Query)

- **데이터 페칭**: 모든 API 호출은 React Query로 관리
- **캐싱**: 배출량 데이터는 `staleTime: 5분`, 리포트는 `staleTime: 0`

#### 4.1.2 URL 상태 (URL Parameters)

- **필터 상태**: analytics페이지에서의 카테고리 선택과 연도 선택, 회사 선택 등은 URL 파라미터로 관리
- **공유 가능한 상태**: 동료에게 링크만 전송하면 동일한 화면 공유 가능
- **브라우저 뒤로가기/앞으로가기**: 필터 상태 변경 히스토리 지원

#### 4.1.3 클라이언트 상태 (Local State)

- **로딩/에러**: React Query (`isLoading`, `isError`, `isFetching`)
- **UI 인터랙션**: 모달 열림/닫힘, 드롭다운 상태, 차트 hover 상태

#### 4.1.4 상태 경계 설정

```
서버 상태
├── companies: 회사 정보 + 각 회사별 배출량 데이터 포함
└── posts: 리포트 데이터

URL 상태 (공유 가능)
├── 카테고리
├── 선택된 연도
├── 선택된 회사들 (미구현)
└── 페이지별 필터 옵션 (미구현)

클라이언트 상태
├── 서버 상태 메타 정보 (isLoading, isError, isFetching)
├── 폼 입력 상태 (리포트 작성/수정)
└── 모달/드롭다운 열림 상태, 차트 hover/클릭 상태
```

### 4.2 데이터 플로우 (Data Flow)

#### 4.2.1 기본 데이터 플로우

```
1. 페이지 로드
   ↓
2. React Query: API 호출 (전체 데이터)
   ↓
3. React Query 훅에서 데이터 가공
   (총 배출량, 연도별/월별/소스별 등의 방법으로 집계 및 필터링)
   ↓
4. 가공된 데이터를 컴포넌트에 전달
   ↓
4.5. (일부 컴포넌트(reports페이지, overview페이지)에서 데이터 재가공 - 향후 훅으로 이동 예정)
   ↓
5. 차트 컴포넌트 렌더링
```

#### 4.2.2 사용자 인터랙션 플로우

```
사용자 액션 (필터 변경, 차트 클릭)
   ↓
로컬 상태 업데이트
   ↓
의존 컴포넌트 리렌더링
   ↓
새로운 계산 결과 표시
```

#### 4.2.3 리포트 CRUD 플로우

```
리포트 작성/수정
   ↓
폼 상태 관리 (로컬)
   ↓
React Query Mutation
   ↓
서버 업데이트 + 캐시 무효화(즉시 최신 데이터 패치)
   ↓
UI 업데이트 및 리디렉션
```
